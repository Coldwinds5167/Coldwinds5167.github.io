<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="冷风喧嚣" href="https://www.coldwinds.top/rss.xml"><link rel="alternate" type="application/atom+xml" title="冷风喧嚣" href="https://www.coldwinds.top/atom.xml"><link rel="alternate" type="application/json" title="冷风喧嚣" href="https://www.coldwinds.top/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Crypto"><link rel="canonical" href="https://www.coldwinds.top/2021/12/crypto-start/"><title>密码学（Crypto）学习方向 | Coldwinds = 冷风喧嚣 = 懒狗一只</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">密码学（Crypto）学习方向</h1><div class="meta"><span class="item" title="创建时间：2021-12-13 09:58:52"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-12-13T09:58:52+08:00">2021-12-13</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>7.2k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>7 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Coldwinds</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://124.221.212.109:666/api.php?807028"></li><li class="item" data-background-image="http://124.221.212.109:666/api.php?369756"></li><li class="item" data-background-image="http://124.221.212.109:666/api.php?851351"></li><li class="item" data-background-image="http://124.221.212.109:666/api.php?981003"></li><li class="item" data-background-image="http://124.221.212.109:666/api.php?300711"></li><li class="item" data-background-image="http://124.221.212.109:666/api.php?689832"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.coldwinds.top/2021/12/crypto-start/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Coldwinds"><meta itemprop="description" content="懒狗一只, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="冷风喧嚣"></span><div class="body md" itemprop="articleBody"><h1 id="前言"><a class="anchor" href="#前言">#</a> 前言</h1><p>我本身并不是学习密码学方向的，所以这里也只是收集整合了一些资料，简单介绍一下密码学方向的学习内容。</p><p>纯粹密码学的考题，在 CTF 中会划分到 Crypto 中，有时也会被归于 MISC 的一种，有时会与 PWN、REVERSE 类型的题目相结合。且题目也趋向于前沿化、论文化。</p><p>与其它方向相比，Crypto 对自身的数学功底要求很高，很大程度上密码学的难点都是数学问题，尤其是数论的内容一定要掌握。</p><h1 id="0x00-安全素养"><a class="anchor" href="#0x00-安全素养">#</a> 0x00 安全素养</h1><h2 id="网络安全法"><a class="anchor" href="#网络安全法">#</a> 网络安全法</h2><p>不要违法，不要违法，不要违法。</p><p><strong>参考资料</strong></p><p><span class="exturl" data-url="aHR0cHM6Ly9iYWlrZS5iYWlkdS5jb20vaXRlbS8lRTQlQjglQUQlRTUlOEQlOEUlRTQlQkElQkElRTYlQjAlOTElRTUlODUlQjElRTUlOTIlOEMlRTUlOUIlQkQlRTclQkQlOTElRTclQkIlOUMlRTUlQUUlODklRTUlODUlQTglRTYlQjMlOTU=">https://baike.baidu.com/item/ 中华人民共和国网络安全法</span></p><h1 id="0x01-基础"><a class="anchor" href="#0x01-基础">#</a> 0x01 基础</h1><h2 id="需要锻炼的能力"><a class="anchor" href="#需要锻炼的能力">#</a> 需要锻炼的能力</h2><ul><li><p><strong>数学能力</strong></p><blockquote><p>学好数学，学好数学，学好数学。</p></blockquote></li><li><p>识别能力</p><blockquote><p>能够识别出题目中使用的密码算法或编码算法。</p></blockquote></li><li><p>攻击能力</p><blockquote><p>能够结合题目环境设置联想到针对特定算法的攻击方法。</p></blockquote></li><li><p>分析能力</p><blockquote><p>能够针对位置算法进行人工分析。</p></blockquote></li><li><p><strong>编程能力</strong></p><blockquote><p>能够编程实现破解该算法的程序，并对自己编写的程序的算法复杂度与运行时间有着清醒的认识。</p><p><strong>了解 Python 编程，会写脚本</strong></p></blockquote></li><li><p>学习能力</p><blockquote><p>能够快速理解最新文献中的密码学攻击方法并加以实现。</p></blockquote></li><li><p>跨领域能力</p><blockquote><p>能够掌握 Reverse、PWN、Web 等其他领域的基础知识。（有时 Crypto 会与其他领域结合）</p></blockquote></li></ul><h2 id="密码学攻击"><a class="anchor" href="#密码学攻击">#</a> 密码学攻击</h2><ul><li><p>唯密文攻击</p><blockquote><p>攻击者只拥有密文。</p></blockquote></li><li><p>已知明文攻击</p><blockquote><p>攻击者拥有一些与密文对应的明文。</p></blockquote></li><li><p>选择明文攻击</p><blockquote><p>攻击者可以进行加密，能够获取指定明文加密后的密文。</p></blockquote></li><li><p>选择密文攻击</p><blockquote><p>攻击者可以进行解密，能够获取指定密文解密后的明文。</p></blockquote></li></ul><h2 id="相关书籍推荐"><a class="anchor" href="#相关书籍推荐">#</a> 相关书籍推荐</h2><ul><li><strong>《数论盖伦》</strong></li><li><strong>《深入浅出密码学》</strong></li><li><strong>《图解密码学》</strong></li><li><strong>《An Introduction to Mathematical Cryptography》</strong></li></ul><h2 id="ctf平台"><a class="anchor" href="#ctf平台">#</a> CTF 平台</h2><p><strong><span class="exturl" data-url="aHR0cHM6Ly9idXVvai5jbi8=">buuoj</span></strong></p><p><span class="exturl" data-url="aHR0cHM6Ly9hZHdvcmxkLnhjdGYub3JnLmNuLw==">攻防世界</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYuYnVna3UuY29tLw==">bugku</span></p><p><span class="exturl" data-url="aHR0cHM6Ly9jdGYuYnVna3UuY29tLw==">ctfhub</span></p><h2 id="学习路线推荐"><a class="anchor" href="#学习路线推荐">#</a> 学习路线推荐</h2><blockquote><p>这里会给出一份学习路线推荐提供参考，实际按照个人情况自由发挥。</p></blockquote><p>作为新手接触密码学，首先从古典密码开始学起，同时还要接触各种新出的、热门的、经典的编码。在 CTF 平台上大量刷题，同时撰写 wp，一些比较生疏的置换密码表要多看几遍，不一定要全记住但需要有个印象。</p><p>在古典密码了解比较透彻后，可以开始接触现代密码，首先推荐学习与古典密码关系较大且对数学要求不是很高的的分组密码，把分组密码的五种工作模式以及对应的攻击手段搞清楚。最好是能够自己通过 C/Python 编写程序复现 AES/DES 的加解密过程。</p><p>到公钥密码这一块，就对数论基础有较高的要求了，当数论理解了之后，公钥密码也很容易搞懂。这里主要讲以下关于数学的学习，数学是一个长期的过程，不用想着一个月就要搞懂一门，对于计算机学院的同学来说，学院会开设线性代数、离散数学、高等数学等数学课程，如果感觉课上没搞懂，可以看网课继续学习。对数论有了一定基础后，就可以去看一些专门介绍某种加密算法和攻击的论文或者书籍。</p><p>如果想在数论方面进一步精进，下面给出一些相关的重点学习内容：</p><blockquote><ol><li>初等数论：整除、同余、二次剩余、原根，并了解有限域上的椭圆曲线。</li><li>线性代数：学校教的内容，以及<strong>向量空间、子空间、线性变换 / 线性映射的概念</strong>。更进阶的话题：对偶空间。</li><li>抽代群论部分：重点关注<strong>有限群</strong>。群、子群、置换群、循环群、陪集与拉格朗日定理（可学群的作用加强理解）、正规子群与商群。<strong>同态、同构</strong>是代数的重要工具。</li><li>抽代环论部分：重点关注<strong>含幺元的有限交换环和欧式环</strong>。环、子环、<strong>理想</strong>与商环、多项式环。</li><li>抽代域论部分：重点关注 ** 有限域。** 至少能理解有限域上有四则运算。有余力可学域的有限扩张、<strong>本原元</strong>、~~ 分式域。</li></ol></blockquote><h1 id="0x02-密码学"><a class="anchor" href="#0x02-密码学">#</a> 0x02 密码学</h1><h2 id="编码"><a class="anchor" href="#编码">#</a> 编码</h2><p>编码（encode）的目的不是为了让别人看到后解不出来，而是代表信息的另外一种表达方式。将原始信息转化为编码信息后进行传输，可以解决一些特殊字符、不可见字符的传输问题。接收者接受到编码信息后将其转化为原始信息的过程称为解码（decode）。</p><p>编码的用处不仅仅是单独出题，很多时候也为作为题目的一部分，因此掌握编码的识别和转化技巧是学习密码学的基础。</p><p>下面是一些 CTF 比赛中常见的编码：</p><ul><li><p>Hex</p><blockquote><p>Hex 是最常用的编码方式之一，它会将信息转化为十六进制。</p><p>在进行其他的编码转化时，有时也会先把信息用 Hex 编码再转化。</p><p>Hex 因为比较简单，本身并不会单独出考点，更多时候是用于数据处理。</p></blockquote></li><li><p>Urlencode</p><blockquote><p>Urlencode 可用于浏览器与网站之间的数据交换，主要是为了解决一些特殊字符的传输过程中产生的问题。</p><p>该编码十分容易理解，即特殊字符在 Hex 编码的基础上，每个字符前置一个 % 即可。</p></blockquote></li><li><p>Morsecode</p><blockquote><p>摩斯电码应该是最耳熟能详的编码方式，其由长短音构成，在得到一串经过摩斯电码编码的信息后，可以对照密码表得到原始信息。</p><p>摩斯电码通常与 Misc 的音频题结合。</p></blockquote></li><li><p>jsfuck</p><blockquote><p>jsfuck 的特征十分明显，只要有 <code>()+[]!</code> 这六个字符组成的的字符串，基本可以确定是 jsfuck 编码。</p></blockquote></li><li><p>uuencode</p><blockquote><p>uuencode 是把二进制文件转化为可见字符文本的编码。</p><p>经过 uuencode 编码的代码杂乱无章，但是其 ASCII 取值为 32 到 95，因此并不会出现小写字母，所以 uuencode 也比较好辨认。</p></blockquote></li><li><p>base</p><blockquote><p>base 系列的编码包括 base64、base32、base16 等，其中 base64 最常出现。</p><p>以 base64 为例，其将输入中的每 3 字节（24 比特）按每 6 比特分成一组，编程 4 个小于 64 的索引值，然后通过一个索引表得到 4 个可见字符。</p><p>如果改变了这个索引表中的内容，所得到的编码称为私有 base64，解码方法也是将索引表换成被修改后的私有表，然后解码。也可以用正常索引表解码后当作代替密码解密。</p></blockquote><blockquote><p>一般情况下，最后有 <code>=</code> 的编码就是 base 编码，当然 base 编码的最后也可以不含 <code>=</code> 。</p><p>区别 base64、base32、base16 的方式是观察编码中的字符是否位于对应的字符集上。</p><p>base64： <code>a-z，A-Z，0-9，+，/以及补位的=</code></p><p>base32： <code>A-Z，2-7以及补位的=</code></p><p>base16： <code>A-F，0-9以及补位的=</code></p></blockquote></li></ul><h2 id="密码"><a class="anchor" href="#密码">#</a> 密码</h2><p>密码与编码最大的区别就在于密码多了一个关键信息：密钥。</p><p>在密码学的学习中，一般用 ** <code>k</code> <strong>代表密钥，用</strong> <code>m</code> <strong>代表明文，用</strong> <code>c</code> ** 代表密文。</p><h3 id="古典密码"><a class="anchor" href="#古典密码">#</a> 古典密码</h3><p>古典密码是最简单的密码加密类型，其对数论的要求并不是很高。在形式上可以分成移位密码和代替密码两类。</p><p>古典密码现在已经不再单独作为加密算法使用，但它们是很多现代密码算法的基石。</p><h4 id="移位密码"><a class="anchor" href="#移位密码">#</a> 移位密码</h4><p>移位密码是密码学中最基础的一种密码形式，将明文根据密钥进行位置的变换得到的密文就是移位密码。</p><ul><li><p>简单移位密码</p><blockquote><p>当明文为 m，密钥为 k 时，移位密码会按照 k 的长度来切分 m，然后按照密钥 k 的顺序对每一部分都进行密钥变化，再把加密后的每一部分重新组合，得到密文。</p></blockquote><blockquote><p>m=&quot;nowyouknowcrypto&quot;</p><p>k=&quot;3124&quot;</p><p>先将 m 按照 k 的长度拆分：nowy、oukn、owcr、ypto。</p><p>按照 k 的顺序进行变换，即将原来的第 1 位放到第 3 位，第 2 位放到第 1 位，第 3 位放到第 2 位，第 4 位放到第 4 位，得到：owny、ukon、wcor、ptyo。</p><p>最后组合每一部分，得到密文：ownyukonwcorptyo。</p></blockquote></li><li><p>曲路密码</p><blockquote><p>曲路密码先将明文填入一个表中，然后按照一定曲路遍历。</p><p>之前画的图找不到了，用 wiki 的图代替一下。</p></blockquote><blockquote><p>m=&quot;The quick brown fox jumps over the lazy dog&quot;</p><p>c=&quot;gesfc inpho dtmwu qoury zejre hbxva lookT&quot;</p></blockquote><p><img data-src="https://ctf-wiki.org/crypto/classical/figure/qulu-table.png" alt="" title="填入 5 行 7 列表（事先约定填充的行列数）"></p></li></ul><p><img data-src="https://ctf-wiki.org/crypto/classical/figure/qulu-road.png" alt="曲路密码" title="加密的回路线（事先约定填充的行列数）"></p><ul><li><p>云影密码</p><blockquote><p>云影密码仅包含 <code>01248</code> 五个数字，其中 <code>0</code> 用于分割，其余数字做加和操作后转换为明文。</p></blockquote><blockquote><p>k=&quot;abcdefghijklmnopqrstuvwxyz&quot;</p><p>m=&quot;120844208481220448041184201428&quot;</p><p>按照 <code>0</code> 划分为 <code>12</code> 、 <code>8442</code> 、 <code>848122</code> 、 <code>448</code> 、 <code>411842</code> 、 <code>1428</code> 。</p><p>解密：1+2=3=c、8+4+4+2=18=r、8+4+8+1+2+2=25=y、4+4+8=16=p、4+1+1+8+4+2=20=t、1+4+2+8=15=o。</p><p>c=&quot;crypto&quot;</p></blockquote></li><li><p>栅栏密码</p><blockquote><p>栅栏密码是一种规则特殊的移位密码，密钥 <code>k</code> 只有一个数字，表示栅栏的长度。</p><p>在加密时把要加密的明文 m 分为 <code>k</code> 个一组，然后每组的第一个字符依次连接，然后每组的第二个字符依次连接…… 拼接而成的字符串就是密文 c。</p></blockquote><blockquote><p>m=&quot;nowyouknowcrypto&quot;</p><p>k=4</p><p>把 m 分为 k 个一组：nowy、oukn、owcr、ypto。</p><p>每组第一、二、三、四个字符连接：nooy、ouwp、wkct、ynro。</p><p>拼接在一起得到密文。</p><p>c=&quot;nooyouwpwkctynro&quot;</p></blockquote></li></ul><h4 id="替代密码"><a class="anchor" href="#替代密码">#</a> 替代密码</h4><p>替代密码首先会建立一个替换表，加密是将需要加密的明文依次通过查表替换为相应的字符，明文字符被逐个替换后会变成无意义的字符串，即密文。替代密码的密钥就是替换表。</p><p>如果替换表只有一个，称为单表替代密码；如果替换表有多个，加密过程中依次使用，则称为多表替代密码。</p><p>针对替代密码最有效的攻击方式是词频分析。</p><h5 id="单表替代密码"><a class="anchor" href="#单表替代密码">#</a> 单表替代密码</h5><ul><li><p>凯撒密码</p><blockquote><p>凯撒密码通过将字母移动一定的位数来实现加密解密，即明文中所有字母都在字母表上向后（或向前）按照一个固定的数目进行偏移后被替换成密文。</p></blockquote><blockquote><p>当偏移值为 3 时，明文中所有字母 A 被替换成 D、B 替换成 E、C 替换成 F，以此类推，然后 W 替换成 Z、X 替换成 A、Y 替换成 B、Z 替换成 C。</p></blockquote><blockquote><p>k=4</p><p>m=&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</p><p>C=&quot;EFGHIJKLMNOPQRSTUVWXYZABCD&quot;</p></blockquote></li><li><p>ROT13</p><blockquote><p>ROT13 本质上是一种特殊的凯撒密码，当 k=13，且只作用于 <code>A-Z、a-z</code> 时，称之为 ROT13。</p></blockquote></li><li><p>埃特巴什码</p><blockquote><p>埃特巴什码与凯撒密码类似，但它的替换表时通过对称获得的。</p></blockquote><blockquote><p>ABCDEFGHIJKLMNOPQRSTUVWXYZ 通过镜像对称得到 ZYXWVUTSRQPONMLKJIHGFEDBCA。</p><p>然后用对称后的字母表替换掉原来字符串中的字母，得到密文。</p></blockquote></li><li><p>培根密码</p><blockquote><p>培根密码一般用两种不同的字体表示密文，使用 AB 代表两种字体，5 个一组，表示密文。</p></blockquote></li><li><p>图形替代密码</p><blockquote><p>即将明文用图形进行代替来实现加密。</p><p>比较经典的有：猪圈密码、跳舞的小人……</p></blockquote></li></ul><h5 id="多表替代密码"><a class="anchor" href="#多表替代密码">#</a> 多表替代密码</h5><p>多表替代密码的举例过于繁琐，这里只简单讲解一下各个多表替代密码的原理</p><ul><li><p>棋盘类密码</p><blockquote><p>常见的棋盘类密码有：Playfair、Polybius、Nihilist。这类密码的密钥是一个 5x5 的棋盘。</p><p>棋盘的生成有以下条件：</p><ol><li>顺序随机</li><li>不能出现重复字母</li><li><code>i</code> 和 <code>j</code> 视为同一个字（也有去除 q 的，总之要保证总数为 25 个）</li></ol><p>在生成棋盘后，不同的加密方式会用不同的转换方式，这里就不继续深入了。</p></blockquote></li><li><p>维吉尼亚密码</p><blockquote><p>维吉尼亚密码是使用一系列凯撒密码组成密码字母表的加密算法，是标准的多表替代密码。</p><p>假设密钥为 CTF，会根据 <code>C、T、F</code> 三个字母在 <code>A-Z</code> 中的偏移得到三个凯撒密码的替换表。然后在进行加密，明文的第一个位置会根据 <code>C</code> 生成的替换表移位加密，第二个位置会根据 <code>T</code> 生成的替换表移位加密，第三个位置会根据 <code>F</code> 生成的替换表移位加密，第四个位置又回到使用 <code>C</code> 生成的替换表移位加密，以此类推。</p></blockquote></li><li><p>希尔密码</p><blockquote><p>希尔密码是运用基本矩阵论原理的替换密码。</p></blockquote></li></ul><h3 id="现代密码"><a class="anchor" href="#现代密码">#</a> 现代密码</h3><h4 id="分组密码"><a class="anchor" href="#分组密码">#</a> 分组密码</h4><p>分组密码是将铭文信息编码表示后的 bit 序列，按照固定长度进行分组，在同一密钥控制下用同意算法逐组进行加密，从而将各个明文分组变换成一个长度固定的密文分组密码。简单来说，古典密码中的替代密码是对一个字符进行替换，分组密码则是对一个分组进行替换。</p><ul><li><p>DES/AES</p><blockquote><p>DES/AES 属于迭代型分组密码，涉及参数包括分组长度、密钥长度、迭代次数（圈数）、圈密钥长度。</p><p>DES 的分组长度为 64bit，密钥长度为 64bit，圈数为 16，圈密钥长度为 48bit。</p><p>AES 的分组长度为 128bit。当密钥长度为 128bit 时，圈数为 10；当密钥长度为 192bit 时，圈数为 12；当密钥长度为 256bit 时，圈数为 14.</p></blockquote><blockquote><p>在 DES 和 AES 中，有两种加解密模式 ECB 和 CBC。其中 CBC 模式的加密会比 ECB 模式多一个初始向量 IV。</p></blockquote></li></ul><h4 id="序列密码"><a class="anchor" href="#序列密码">#</a> 序列密码</h4><p>序列密码指将种子密钥通过密钥流生成器产生的伪随机序列与明文简单结合生成密文。其中与明文结合的元素称为密钥流，将产生密钥流元素的部件称为密钥流发生器。序列密码的密码强度主要取决于密钥流发生器的设计。</p><h4 id="公钥密码"><a class="anchor" href="#公钥密码">#</a> 公钥密码</h4><p>前面所讲的密码的加密密钥和解密密钥都是相同的，从公钥密码开始，加密密钥和解密密钥就不是同一个密钥了。其中加密密钥是公开的，解密密钥是保密的，并且很难由加密密钥推出解密密钥。</p><p>说到公钥密码，就不得不提到 RSA，RSA 也是 CTF 比赛中最常出现的公钥密码。</p><h5 id="rsa"><a class="anchor" href="#rsa">#</a> RSA</h5><p>学习 RSA，需要具备一定的数论知识，否则很难理解透彻。</p><p>这里先过一遍 RSA 加密解密的流程。</p><blockquote><p>小红需要给小刚发送一段隐私信息，但他们之间的通讯通道被小明监听着，因此小红不能直接把信息发给小刚。</p><p>于是小刚先挑选两个大素数 <code>p</code> 和 <code>q</code> ，然后相乘得出了 <code>n=p*q</code> ，然后又挑了一个合适的素数 <code>e</code> 。这时小刚把 <code>（n，e）</code> 发送给了小红，当然小明也得知了这个信息。</p><p>小红拿到 <code>（n，e）</code> 后，把隐私信息通过 Hex 和 Padding 转换为一串数字 <code>m</code> ，然后通过计算得到 <code>c（c=m^e mod n）</code> ，然后把 <code>c</code> 发送给了小刚，当然小明也得到了 <code>c</code> 。</p><p>这时，我们观察一下小红、小刚、小明所掌握的信息：</p><ul><li>小红：c、m、e、n</li><li>小刚：c、e、n、p、q</li><li>小明：c、e、n</li></ul><p>当小刚收到小红发送的信息 <code>c</code> 后，通过计算 <code>e</code> 关于 <code>n</code> 的欧拉函数的逆元，求出了 <code>d</code> ，然后通过 <code>d</code> 进行计算就可以算出 <code>m=c^d mod n</code> ，再通过 Hex 的处理就得到了小红发送的隐私信息。而小明没有掌握 <code>p和q</code> ，就无法计算出 <code>d</code> ，从而无法解密 <code>c</code> 来获取 <code>m</code> 。</p><p>在上面这个过程中（n，e）就是公钥，（n，d）就是私钥。</p></blockquote><p>下面列出了公、私钥的生成算法和加密解密算法</p><blockquote><p>公、私钥的生成：</p><ol><li>随机选择两个不同大素数 p 和 q，计算 N=p*q。</li><li>根据欧拉函数，求得 φ(N)=φ(p)φ(q)=(p-1)(q-1)。</li><li>选择一个小于 φ(N) 的整数 e，使 e 和 φ(N) 互质。并求得 e 关于 φ(N) 的模反元素，命名为 d，有 ed≡1 (mod φ(N))。</li></ol><p>此时，(N,e) 是公钥，(N,d) 是密钥。</p></blockquote><blockquote><p>信息加密：</p><ol><li><p>先将信息以一个双方约定好的格式转化为一个小于 N，且于 N 互质的整数 m。</p></li><li><p>对 m 利用如下公式加密</p><p>m^e≡c (mod N)</p></li></ol></blockquote><blockquote><p>信息解密：</p><p>利用密钥 d 按照如下公式进行解密</p><p>​ c^d≡m (mod N)</p></blockquote><h5 id="rsa算法的攻击"><a class="anchor" href="#rsa算法的攻击">#</a> RSA 算法的攻击</h5><ul><li><p>直接模数分解</p><blockquote><p>正常情况下，攻击者并不知道 p 和 q，因此无法计算出私钥 d 来破解加密信息 m。</p><p>但是如果 n 的取值过小，攻击者可以通过爆破的手段分解得到 p 和 q，从而破解出密文。</p></blockquote></li><li><p>费马分解和 Pollard_rho 分解</p><blockquote><p>当 n 的取值过小时，可以通过直接模数分解得到 p 和 q。但即使 n 的取值很大，而 p 和 q 差距过远或者差距过小时，也会产生问题。</p><p>其中费马分解适用于 p 和 q 差距过小的情况，Pollard_rho 分解适用于 p 和 q 差距过大的情况。</p></blockquote></li><li><p>公约数模数分解</p><blockquote><p>如果在进行了两次信息传递时，使用的两个大素数 p 和 q 有一个是相等的，攻击者就可以通过对两次通信的 n 进行求公约数的计算进而分解出两次通信的 n，即 n1 和 n2。n1 和 n2 具有一个共同的素因子 p，这是通过 n1、n2 分别去除素因子 p 就可以分解出两次使用的素数 q1 和 q2，然后可以解密了。</p></blockquote></li><li><p>小指数明文爆破</p><blockquote><p>如果生成公钥时使用的 e 太小，并且要传输的信息也很小时，就会出现 m<sup>e＜n 的情况，这时直接对 c 开 e 次根号就可以得到明文 m。如果 m</sup>e＞n 但没有超过 n 太多，即 k*n＜m<sup>e＜(k+1)*n，当 k 处于可以爆破的大小时，可以通过关系式 k*n-c=m</sup>e 来爆破明文。</p></blockquote></li><li><p>选择明文攻击</p><blockquote><p>如果可以对任意密文解密，但不能对 C 解密，可以求出 C 的 N 上 d 的逆元 C<sup>-1，然后求 C</sup>-1 的明文 M'。M' 即为明文的逆元，再次求逆即可。</p></blockquote></li><li><p>LLL-attack</p><blockquote><p>在已知 e 且 e 较小的情况下，如果已经泄露了一部分密文（例如在信息开头打招呼），或者泄露了 p 或 q 的一部分，又或者是直接泄露了一部分明文的 bit，当泄露的信息长度足够时，可以通过 Coppersmith method 的方法求得明文。</p></blockquote></li><li><p>Wiener Attack &amp; Boneh Durfee Attack</p><blockquote><p>如果 e 很大但生成的 d 过下，也会被成功攻击，即 RSA Wiener Attack。</p></blockquote></li><li><p>共模攻击</p><blockquote><p>如果在两次通讯中使用了相同的 n，并且是对相同的 m 加密，那么可以不计算 d 直接计算出 m 的值。</p><p>即当又两组及以上的 RSA 加密过程，其中两次的 m 和 n 都是相同的，就可以通过计算直接计算出 m。</p></blockquote></li><li><p>广播攻击</p><blockquote><p>在连续进行 RSA 加密时，如果选择的加密指数 e 较小，并且每次加密的信息都是相同的，可以通过中国剩余定理计算出一个数 c<sup>e，这时对 c</sup>e 开 e 次根号就可以得到 m。</p></blockquote></li><li><p>相关消息攻击</p><blockquote><p>如果用同一公钥对两个具有某种线性关系的消息 m1 和 m2 进行加密。当 e 比较小时，就可以根据加密后的 c1 和 c2 九三出相应的 m1 和 m2.</p></blockquote></li></ul><h4 id="哈希"><a class="anchor" href="#哈希">#</a> 哈希</h4><p>哈希，也叫散列，可以把任意长度的输入，变换成固定长度的输出，输出结果即为哈希值。这种转换是一种压缩映射，即哈希值的空间通常远小于输入的空间，导致不同的输入可能会拥有相同的哈希值，所以不能通过哈希值来唯一确定输入值。。</p><p>哈希函数有很多，常见的有 MD5、sha1、sha256 等。</p><h5 id="哈希函数的攻击"><a class="anchor" href="#哈希函数的攻击">#</a> 哈希函数的攻击</h5><ul><li><p>哈希碰撞（暴力攻击）</p><blockquote><p>不依赖于任何算法细节，暴力破解明文，仅与 Hash 值长度有关。</p></blockquote></li><li><p>哈希长度扩展攻击</p><blockquote><p>在计算 hash 的方式 secret+message 为明文的情况下，可以进行哈希长度扩展攻击，使攻击者可以在不知道 secret 的情况下修改 message 并得到另外一个 hash 值。</p></blockquote></li></ul><div class="tags"><a href="/tags/Crypto/" rel="tag"><i class="ic i-tag"></i> Crypto</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-12-13 10:11:41" itemprop="dateModified" datetime="2021-12-13T10:11:41+08:00">2021-12-13</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Coldwinds <i class="ic i-at"><em>@</em></i>冷风喧嚣</li><li class="link"><strong>本文链接：</strong> <a href="https://www.coldwinds.top/2021/12/crypto-start/" title="密码学（Crypto）学习方向">https://www.coldwinds.top/2021/12/crypto-start/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2021/12/pwn&reserve-start/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;124.221.212.109:666&#x2F;api.php?632305" title="二进制（pwn、reverse）学习方向"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>二进制（pwn、reverse）学习方向</h3></a></div><div class="item right"><a href="/2021/12/web-start/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;124.221.212.109:666&#x2F;api.php?404917" title="Web学习方向"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>Web学习方向</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x00-%E5%AE%89%E5%85%A8%E7%B4%A0%E5%85%BB"><span class="toc-number">2.</span> <span class="toc-text">0x00 安全素养</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">网络安全法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E5%9F%BA%E7%A1%80"><span class="toc-number">3.</span> <span class="toc-text">0x01 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E9%94%BB%E7%82%BC%E7%9A%84%E8%83%BD%E5%8A%9B"><span class="toc-number">3.1.</span> <span class="toc-text">需要锻炼的能力</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6%E6%94%BB%E5%87%BB"><span class="toc-number">3.2.</span> <span class="toc-text">密码学攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E4%B9%A6%E7%B1%8D%E6%8E%A8%E8%8D%90"><span class="toc-number">3.3.</span> <span class="toc-text">相关书籍推荐</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ctf%E5%B9%B3%E5%8F%B0"><span class="toc-number">3.4.</span> <span class="toc-text">CTF 平台</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF%E6%8E%A8%E8%8D%90"><span class="toc-number">3.5.</span> <span class="toc-text">学习路线推荐</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-number">4.</span> <span class="toc-text">0x02 密码学</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81"><span class="toc-number">4.1.</span> <span class="toc-text">编码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.</span> <span class="toc-text">密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.1.</span> <span class="toc-text">古典密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E4%BD%8D%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">移位密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">替代密码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.1.2.1.</span> <span class="toc-text">单表替代密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9B%BF%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.1.2.2.</span> <span class="toc-text">多表替代密码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.2.</span> <span class="toc-text">现代密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">分组密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">序列密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E9%92%A5%E5%AF%86%E7%A0%81"><span class="toc-number">4.2.2.3.</span> <span class="toc-text">公钥密码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#rsa"><span class="toc-number">4.2.2.3.1.</span> <span class="toc-text">RSA</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#rsa%E7%AE%97%E6%B3%95%E7%9A%84%E6%94%BB%E5%87%BB"><span class="toc-number">4.2.2.3.2.</span> <span class="toc-text">RSA 算法的攻击</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%88%E5%B8%8C"><span class="toc-number">4.2.2.4.</span> <span class="toc-text">哈希</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E7%9A%84%E6%94%BB%E5%87%BB"><span class="toc-number">4.2.2.4.1.</span> <span class="toc-text">哈希函数的攻击</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Coldwinds" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Coldwinds</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">11</span> <span class="name">文章</span></a></div><div class="item tags"><a href="/tags/"><span class="count">6</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0NvbGR3aW5kczUxNjc=" title="https:&#x2F;&#x2F;github.com&#x2F;Coldwinds5167"><i class="ic i-github"></i></span> <a href="/825592085@qq.com" title="825592085@qq.com" class="item email"><i class="ic i-envelope"></i></a></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-star"></i>清单</a><ul class="submenu"><li class="item"><a href="/Bangumi/" rel="section"><i class="ic i-magic"></i>番剧</a></li><li class="item"><a href="/music/" rel="section"><i class="ic i-music"></i>歌单</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友站</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2021/12/pwn&reserve-start/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2021/12/web-start/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/pwn-environment/" title="pwn环境搭建">pwn环境搭建</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/pwn&reserve-start/" title="二进制（pwn、reverse）学习方向">二进制（pwn、reverse）学习方向</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/Blockchain-profiles/" title="区块链简介">区块链简介</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/03/Blockchain-2019qwb-babybank/" title="2019-强网杯-babybank">2019-强网杯-babybank</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/crypto-start/" title="密码学（Crypto）学习方向">密码学（Crypto）学习方向</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/pwn-IOFILE-vtable/" title="IO_FILE介绍及vtable劫持">IO_FILE介绍及vtable劫持</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/pwn-offbynull/" title="off-by-null">off-by-null</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2022/04/pwn-bins-profiles/" title="bins-profiles">bins-profiles</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/web-start/" title="Web学习方向">Web学习方向</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2021/12/Blockchain-ReEntrancy/" title="重入攻击">重入攻击</a></span></li></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Coldwinds @ Coldwinds</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">60k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">54 分钟</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2021/12/crypto-start/",favicon:{show:"欢迎回来~",hide:"网页消失啦~"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(t){return t.includes("#")},function(t){return new RegExp(LOCAL.path+"$").test(t)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>